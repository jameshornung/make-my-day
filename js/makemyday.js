////////////// VARIABLE DECLARATION ////////////////////////
var Choices = {
    dateNights: [
    {
        parking: {},
        restaurant: {
            name: 'Salty Sow',
            address: '1917+manor+road,austin,tx',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJ61i-aZO1RIYRKgxgoJHJc28'
        },
        bar: {
            name: 'Butterfly Bar',
            address: '2307+Manor+Rd,Austin,TX+78722',
            labelLetter: 'B',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJ_SqzjOy1RIYR09ZBlUuVbyc'
        },
        zipCode: '78722'
    }, 
    {
        parking: {},
        restaurant: {
            name: 'Second Bar and Kitchen',
            address: '200+congress+avenue+austin+TX',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJjxgwfgi1RIYRFkkL2iIIb8g'
        },
        bar: {
            name: 'Garage',
            address: '503+colorado+street+austin+tx',
            labelLetter: 'G',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJWdi3AAm1RIYRVOzVjpc3hOQ'
        },
        event: {
            name: 'The Elephant Room',
            address: '315+congress+avenue+austin+tx',
            labelLetter: 'E',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJ5ckHaQi1RIYRc48001D9cm4'
        },
        zipCode: '78701'
    },
    {
        parking: {},
        restaurant: {
            name: 'Foreign and Domestic',
            address: '306+east+53rd+street+austin+tx',
            labelLetter: 'F',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJEaO0VhPKRIYRmmIiuYiG3hw'
        },
        bar: {
            name: 'Drink.Well',
            address: '207+east+53rd+street+austin+tx',
            labelLetter: 'D',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJc262qWzKRIYRxo9PBUampxk'
        },
        zipCode: '78751'
    },
    {
        parking: {},
        restaurant: {
            name: 'Henris Cheese and Wine',
            address: '2026+south+lamar+boulevard+austin+tx',
            labelLetter: 'H',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJ7wS0Lt-0RIYRUoaTLrbKLWk'
        },
        bar: {
            name: 'Opa Coffee and Wine Bar',
            address: '2050+south+lamar+boulevard+austin+tx',
            labelLetter: 'O',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJL5GO19i0RIYRkg9oMW_kpFs'
        },
        zipCode: '78704'
    }],
//Template----------------------------------------------
    // {
    //     parking: {},
    //     restaurant: {
    //         name: '',
    //         address: '',
    //         labelLetter: '',
    //         markerColor: '',
    //         type: '',
    //         placeID: ''

    //     },
    //     bar: {
    //         name: '',
    //         address: '',
    //         labelLetter: '',
    //         markerColor: '',
    //         type: '',
    //         placeID: ''
    //     },
    //     zipCode:
    //     },

// }],

//TOTALLY AUSTIN========================================

    totallyAustin: [{
        parking: {},
        restaurant: {
            name: 'Stubbs BBQ',
            address: '801+Red+River+St,Austin,TX+78701',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJSVyqJ6S1RIYRdx8PPPRl9Is'
        },
        bar: {
            name: 'Handle Bar',
            address: '121+E+5th+St,Austin,TX+78701',
            labelLetter: 'H',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJixveLgi1RIYRg-FziMQPbwk'
        }
    }, {
        parking: {},
        restaurant: {
            name: 'Stubbs BBQ',
            address: '801+Red+River+St,Austin,TX+78701',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJSVyqJ6S1RIYRdx8PPPRl9Is'
        },
        bar: {
            name: 'Handle Bar',
            address: '121+E+5th+St,Austin,TX+78701',
            labelLetter: 'H',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJixveLgi1RIYRg-FziMQPbwk'
        }
    }, {
        parking: {},
        restaurant: {
            name: 'Stubbs BBQ',
            address: '801+Red+River+St,Austin,TX+78701',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJSVyqJ6S1RIYRdx8PPPRl9Is'
        },
        bar: {
            name: 'Handle Bar',
            address: '121+E+5th+St,Austin,TX+78701',
            labelLetter: 'H',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJixveLgi1RIYRg-FziMQPbwk'
        }
    }, {
        parking: {},
        restaurant: {
            name: 'Stubbs BBQ',
            address: '801+Red+River+St,Austin,TX+78701',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJSVyqJ6S1RIYRdx8PPPRl9Is'
        },
        bar: {
            name: 'Handle Bar',
            address: '121+E+5th+St,Austin,TX+78701',
            labelLetter: 'H',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJixveLgi1RIYRg-FziMQPbwk'
        }
    }, {
        parking: {},
        restaurant: {
            name: 'Stubbs BBQ',
            address: '801+Red+River+St,Austin,TX+78701',
            labelLetter: 'S',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJSVyqJ6S1RIYRdx8PPPRl9Is'
        },
        bar: {
            name: 'Handle Bar',
            address: '121+E+5th+St,Austin,TX+78701',
            labelLetter: 'H',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJixveLgi1RIYRg-FziMQPbwk'
        }
    }],

    //HAPPY HOUR================================================
    happyHour: [{
        parking: {},
        restaurant: {
            name: 'Takoba',
            address: '1411+east+7th+street+austin+tx',
            labelLetter: 'T',
            markerColor: 'blue',
            type: 'restaurant',
            placeID: 'ChIJGWJ6krC1RIYRTjImg9W2fNk'
        },
        bar: {
            name: 'Shangri-La',
            address: '1016+east+sixth+street+austin+tx',
            labelLetter: 'S',
            markerColor: 'red',
            type: 'bar',
            placeID: 'ChIJwc9096-1RIYRIEXZT4wwdNk'
        },
        zipCode: '78702'
    },
    {
    parking: {},
    restaurant: {
        name: 'Bangers Sausage House and Beer Garden',
        address: '79+rainey+street+austin+tx',
        labelLetter: 'B',
        markerColor: 'blue',
        type: 'restaurant',
        placeID: 'ChIJ20zQ16u1RIYRHXxs8v4BacY'
    },
    bar: {
        name: 'The Blackheart',
        address: '86+rainey+street+austin+tx',
        labelLetter: 'B',
        markerColor: 'red',
        type: 'bar',
        placeID: 'ChIJsRlvd6m1RIYRqhaAjwWlnpo'
    },
    zipCode: '78701'
},
{
    parking: {},
    restaurant: {
        name: 'Torchys Tacos',
        address: '1822+south+congress+avenue+austin+tx',
        labelLetter: 'T',
        markerColor: 'blue',
        type: 'restaurant',
        placeID: 'ChIJi1wGI9O0RIYRptZhcRFaglw'
    },
    bar: {
        name: 'The South Congress Hotel',
        address: '1603+south+congress+avenue+austin+tx',
        labelLetter: 'S',
        markerColor: 'red',
        type: 'bar',
        placeID: 'ChIJh91qhvy0RIYRtJ71kCXMjsc'
    },
    zipCode: '78704'
} 
    ]
};

function theFunction(date) {
    /////////add a custom icon to labelLetter! /////////////
    $('#make-my-day').on('click', function() {
        var map;
        /// creates the map
        function initMap() {
            map = new google.maps.Map(document.getElementById('googlemap'), {
                // got lazy, set the center to Austin
                center: { lat: 30.267153, lng: -97.743061 },
                zoom: 15
            });

        }
        //creates an ajax call to determine the weather at a specific zip code
        function showWeather(){
            console.log('weather');
            var key = '7f2c1ad71abdf07a660a8667474497f2';
            var zip = date.zipCode;
            var requestURL = 'http://api.openweathermap.org/data/2.5/weather?zip=' + zip + ',us&units=imperial&APPID=' + key 
            
            $.ajax({
                url: requestURL,
                method: 'GET'
            })
            .done(function(response){

                var currentTemp = $('<p>').text('Current Temp: ' + Math.round(response.main.temp) + ' degrees');
                var highTemp = $('<p>').text('High Today: ' + Math.round(response.main.temp_max) + ' degrees');
                var humidity = $('<p>').text('Humidity: ' + response.main.humidity + ' percent');
                var windSpeed = $('<p>').text('Wind Speed: ' + response.wind.speed + ' mph');

                $('#weather').html('');
                
                $('#weather').append(currentTemp);
                $('#weather').append(highTemp);
                $('#weather').append(humidity);
                $('#weather').append(windSpeed);

            })
        };
        showWeather();
        initMap();
        /// creates clickable markers
        var infowindow = new google.maps.InfoWindow();
        ///creates a boundary for each marker to change map size
        var bounds = new google.maps.LatLngBounds();
        /// creates a new location/places call
        var newLocation = new google.maps.places.PlacesService(map);
        /// stores data from the date choice. NEEDS PARKING INFO ///
        var locationArray = [date.restaurant.placeID, date.bar.placeID];
        var labelArray = [date.restaurant.labelLetter, date.bar.labelLetter];
        var latLngArray = [];
        /// generates markers and corresponding dynamic html
        for (i = 0; i < locationArray.length; i++) {
            newLocation.getDetails({
                placeId: locationArray[i]
            }, function(place, status) {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                    var marker = new google.maps.Marker({
                        map: map,
                        position: place.geometry.location,
                    });
                    /// dynamic html
                    $('#googleplacedata').append('<div class="placeNameData">' + place.name + '</div><div class="placeFormattedAddressData">' + place.formatted_address + '</div><div class="placePriceLevelData">' + 'Price Level: ' + place.price_level + '</div><div class="placePhoneNumberData">' + place.international_phone_number + '</div>');
                    $('#googleplacedata').append('<div class="placeHoursTitleData">Hours</div><div class="placeHoursData">' + place.opening_hours.weekday_text[0] + '<br>' + place.opening_hours.weekday_text[1] + '<br>' + place.opening_hours.weekday_text[2] + '<br>' + place.opening_hours.weekday_text[3] + '<br>' + place.opening_hours.weekday_text[4] + '<br>' + place.opening_hours.weekday_text[5] + '<br>' + place.opening_hours.weekday_text[6] + '<br>' + '</div>');
                    $('#googleplacedata').append('<div class="placeWebsiteData"><a href="' + place.website + '">' + place.website + '</a></div>')
                    /// changes map size
                    bounds.extend(marker.position);
                    latLngArray.push(marker.position);
                    console.log(latLngArray);
                    /// makes markers clickable
                    google.maps.event.addListener(marker, 'click', function() {
                        infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + place.formatted_address + '</div>');
                        infowindow.open(map, this);
                    });
                    /// fits map to new boundaries
                    map.fitBounds(bounds);
                }
            });
        };
    })
};

$(document).ready(function() {
    // $(this).scrollTop(0);
    $('#make-my-day').hide();

    $('#dropdownMenu1').on('click', function(date) {
        $('#make-my-day').show('slow');
        var date = Choices.dateNights[Math.floor(Math.random() * Choices.dateNights.length)];
        theFunction(date);
    });
    $('#dropdownMenu3').on('click', function(date) {
        $('#make-my-day').show('slow');
        var date = Choices.totallyAustin[Math.floor(Math.random() * Choices.totallyAustin.length)];
        theFunction(date);
    });
    $('#dropdownMenu2').on('click', function(date) {
        $('#make-my-day').show('slow');
        var date = Choices.happyHour[Math.floor(Math.random() * Choices.happyHour.length)];
        theFunction(date);
    })
});
